# 计算机网络

## 一、计算机网络概述

### 1.1名词概念

#### 互连网与互联网

网络连接多个计算机，互连网连接多个网络，是网络的网络
互联网是全球最大的互连网，采用的是TCPIP协议簇作为通信规则。
互联网＜互连网

#### Internet和internet

Internet是专用名词，指互联网
internet是通用名词，指互连网

#### ISP

互联网服务提供商 internet service provider
从互联网管理机构 批发 IP地址，再卖给各个用户
互联网实际的拥有者是无数个ISP
ISP可以是公司也可以是有资格的个人

分为主干ISP、地区ISP、本地ISP。绝大多数人都是通过连接本地ISP获取服务的，本地ISP可以直接连到地区ISP和主干ISP。主干ISP是专门的几个公司维持的，服务面积大，速度快。

#### RFC

### 1.2性能指标

#### 速率

数据的传送速率，也称数据率或者比特率
最重要的一个性能指标
1000一级，有  kb/s  Mb/s Gb/s T  P  E   Z  Y

注意点
存储容量很容易混淆
存储容量为字节B, 2的10方为一级     B   KB  MB  GB  TB  PB  EB  ZB  YB

#### 带宽



#### 吞吐量



#### 时延

时延是时间，单位是s，指数据从网络的一端传送到另一端的时间。

##### 发送时延

指的是主机或者路由器从发送的第一个bit开始到最后一个bit所需的时间。
=数据帧长度(bit)/发送速率(bit/s)

##### 传播时延

电磁波在信道中传播一定距离的时间
=信道长度(m)/传播速率(m/s)

##### 处理时延

主机或路由器在收到分组时要花费一定的时间进行处理，分析分组首部、提取数据部分、差错检验等等。

##### 排队时延

数据在路由器中要经过输入队列和输出队列，进行等待后再处理
时长取决于当时的网络通信量，如果排队时丢失分组则排队时延为无穷大

##### 注意点

1. 高速链路是指发送速率快，发送时延小 ，与传播速率、传播时延无关
2. 传播时延与信号的传输距离有关，而传播速度是固定值，光纤为20000km/s，铜线电缆为23000km/s

##### 时延带宽积

=传播时延*带宽
又称为以bit为单位的链路长度
表示一条链路(时间为单位)中的bit数量

##### 往返时间 RTT

这是一个很重要的性能指标
=两倍传播时延+末端处理时间(确认时间)
一般确认时间不计
在互联网中，RTT还包括各个中间节点的处理时延、排队时延、转发的发送时延

##### 利用率

信道利用率和网络利用率，两种

信道利用率=有数据时间/总时间

当利用率趋近于1时，时延趋近无穷大

相当于高速公路，车越多利用率大，但是有可能堵车，这样时延就大

### 1.3 分层思想

##### 协议



##### 分层的好处



##### 每一层的共有功能



##### 各层传输单位



## 二、物理层



## 三、数据链路层

这是计算机网络考研的大头，应该好好学一下，但是面试问的很少。

##### 可靠传输与透明传输的对比

###### **透明传输**

**传输的内容不会被错认成一些通道的控制数据**，**从而实现在通道中无障碍的传输**。在通道中传输时，往往是待传输数据和一些控制字段或者其他字段一起传输。

官方定义：**透明传输是指不管所传数据是什么样的比特组合，都应当能够在链路上传送**。当所传数据中的比特组合恰巧与某一个控制信息完全一样时，就必须采取适当的措施，使接收方不会将这样的数据误认为是某种控制信息。这样才能保证数据链路层的传输是透明的。

###### **可靠传输**：

传输的内容一方面完整无缺失，一方面准确无错误，即**传输的内容不缺失也不错误**

官方定义：**就是采用一系列技术来保障信息在发送方和接收方准确、精确的传输**。

## 四、网络层

主要任务是把**分组**从源端传输到目的端，其传输的基本单位是**数据包**。
数据包是多个分组组成的。

### 4.1 功能

1. 路由选择与分组转发
2. 异构网络互联
3. 拥塞控制（开环控制静态、闭环控制动态）

### 4.2 路由算法



### 4.3 IP协议





## 五、传输层

传输层包含两个重要协议：TCP协议和UDP协议。

### 5.1 概述

#### 5.1.1 三大功能

1. 提供进程之间的逻辑通信
2. 复用和分用
3. 传输层对收到的报文进行差错检测

提供进程之间的逻辑通信是相对于网络层来说的，网络层是提供主机到主机的通信，传输层则多做了一步对数据的统一发送和分发的步骤。只有将数据传输到对应的进程才算是真正的传输完成，其实网络层和传输层完全可以合并，但是为了解耦，将整个通信过程分成了两个部分，一个部分是主机到主机（网络层实际做的事），一部分是主机到进程（传输层实际做的事），传输层由于调用了网络层服务从而实现了进程到进程的通信。

复用指多个进程都使用传输层传输数据，分用指数据由传输层分别分到各个进程。

由于网络层只对IP数据头做了差错控制，则不能保证数据的可靠性。因此需要传输层来对数据进行差错控制。但是传输层不一定完成了这件事，因为UDP协议没有做到差错控制。

#### 5.1.2 UDP协议和TCP协议的比较

- UDP：不可靠、无连接、时延小、适合小文件传输
- TCP：可靠、面向连接、时延大、适合大文件传输

两个协议都有各的用处，没有优劣之分。TCP用的更多，UDP用的少，比如发送一条短消息就可以采用UDP协议。

UDP协议尽管不可靠，但是我们在应用层能采用编程的方式让它变得可靠，因此可以使用。

#### 5.1.3 端口与套接字

端口唯一标识了一台主机中的一个进程，其大小为2字节，16位，0 -65535
0-1023是TCP/IP在中的常用端口号 ，1024 -49151是分配给其他进程使用 ，49152- 65535给各个已分配的进程运行时动态选用。一些常用的应用进程对应的端口号要记住 

- 21 FTP
- 23 TELNET 
- 25 SMTP
- 53  DNS
- 80 HTTP

网络中采用发送方和接收方的套接字来识别端点。**套接字Socket = （主机IP地址，端口号）**套接字可以唯一识别网络中的一台主机的一个进程。

### 5.1 TCP协议

#### 5.1.1 特点



#### 5.1.2 TCP报文首部



#### 5.1.3 连接管理



#### 5.1.4 可靠传输机制



#### 5.1.5 流量控制



#### 5.1.6 拥塞控制



#### 5.1.7 总结

1. 特点：有连接、一对一、提供可靠交付、全双工通信、面向字节流
2. 首部：20字节、源端口、目的端口、序号、确认号等控制信息
3. 连接管理：三次握手、四次挥手
4. 可靠传输机制：
   1. 序号
   2. 确认
   3. 重传
5. 流量控制
6. 拥塞控制



### 5.2 UDP协议

UDP协议仅在IP数据包服务之上添加了分用复用和差错检测两个功能，这是传输协议的最少功能。

#### 5.2.1 特点

1. 无需建立连接。减少了连接时延。
2. 使用最大努力交付，即不保证可靠交付
3. 面向报文，适合少量数据传输
4. 无拥塞控制，适合实时应用
5. 首部开销小，只有8字节，四个部分（2字节16位）

这里的面向报文是指将应用层的报文直接添加UDP首部，不对报文本身做处理，然后提交给IP层。接收时也仅去掉首部就原封不动的将报文传给进程。报文不可分割，是UDP数据包的最小处理单位。

UDP适合传输数据量小的应用以及一些对时延要求高的应用。如DNS，实时视频会议。

UDP并不能保证可靠传输，因此应用层需要建立可靠传输机制。一旦UDP报文出错，大概率是直接丢弃，小概率继续传输并附带错误报告。

#### 5.2.2 首部：

8字节，分别为源端口号、目的端口号、长度、校验和（16位*4）

#### 5.2.3 校验：

采用首部、伪首部（模拟ip数据包首部）、数据进行二进制反码运算求和再取反

#### 5.2.1 总结：

1. 功能：分用复用、差错检测两个功能。
2. 特点：无连接、面向报文、首部开销小、最大努力交付，应用层保证可靠交付、无拥塞控制
3. 校验：采用首部、伪首部（模拟ip数据包首部）、数据进行二进制反码运算求和再取反

